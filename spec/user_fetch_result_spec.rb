require 'spec_helper'

describe TwitterShuwei::UserFetchResult do
  it "should return user info" do
    response = {"id" => 213747670, "id_str" => "213747670", "name" => "The twitter Ruby Gem", "screen_name" => "gem", "location" => "San Francisco, CA", "description" => "A Ruby wrapper for Twitter API", "url" => "http://t.co/rnjr99Mf9o", "entities" => {"url" => {"urls" => [{"url" => "http://t.co/rnjr99Mf9o", "expanded_url" => "http://rubygems.org/gems/twitter", "display_url" => "rubygems.org/gems/twitter", "indices" => [0, 22]}]}, "description" => {"urls" => []}}, "protected" => false, "followers_count" => 1181, "friends_count" => 7, "listed_count" => 63, "created_at" => "Tue Nov 09 18:03:22 +0000 2010", "favourites_count" => 3, "utc_offset" => -25200, "time_zone" => "Pacific Time (US & Canada)", "geo_enabled" => true, "verified" => false, "statuses_count" => 86, "lang" => "en", "status" => {"created_at" => "Sun Jul 28 07:55:11 +0000 2013", "id" => 361394389903355905, "id_str" => "361394389903355905", "text" => "Retiring the fail whale. https://t.co/hXcj6QlT3r", "source" => "<a href=\"http://rubygems.org/gems/twitter\" rel=\"nofollow\">The Ruby Gem</a>", "truncated" => false, "in_reply_to_status_id" => nil, "in_reply_to_status_id_str" => nil, "in_reply_to_user_id" => nil, "in_reply_to_user_id_str" => nil, "in_reply_to_screen_name" => nil, "geo" => nil, "coordinates" => nil, "place" => nil, "contributors" => nil, "retweet_count" => 3, "favorite_count" => 2, "entities" => {"hashtags" => [], "symbols" => [], "urls" => [{"url" => "https://t.co/hXcj6QlT3r", "expanded_url" => "https://github.com/sferik/twitter/commit/a4ef3acc035dc2786a9b11a295c4c59ba4f51dcd", "display_url" => "github.com/sferik/twitter", "indices" => [27, 50]}], "user_mentions" => []}, "favorited" => false, "retweeted" => false, "possibly_sensitive" => false, "lang" => "en"}, "contributors_enabled" => false, "is_translator" => false, "profile_background_color" => "022330", "profile_background_image_url" => "http://a0.twimg.com/images/themes/theme15/bg.png", "profile_background_image_url_https" => "https://si0.twimg.com/images/themes/theme15/bg.png", "profile_background_tile" => false, "profile_image_url" => "http://a0.twimg.com/profile_images/2921081357/9e8b8662cd9c4c06887365d559e714a3_normal.png", "profile_image_url_https" => "https://si0.twimg.com/profile_images/2921081357/9e8b8662cd9c4c06887365d559e714a3_normal.png", "profile_link_color" => "0084B4", "profile_sidebar_border_color" => "A8C7F7", "profile_sidebar_fill_color" => "C0DFEC", "profile_text_color" => "333333", "profile_use_background_image" => true, "default_profile" => false, "default_profile_image" => false, "following" => false, "follow_request_sent" => false, "notifications" => false}
    user = TwitterShuwei::UserFetchResult.new(response).to_model
    user.name.should == "The twitter Ruby Gem"
    user.location.should == "San Francisco, CA"
    user.description.should == "A Ruby wrapper for Twitter API"
  end

  it "should return timeline tweets" do
    response = {"created_at"=>"Fri Jan 25 19:52:43 +0000 2013", "id"=>294895596270141441, "id_str"=>"294895596270141441", "text"=>"RT @twitterapi: Looking for a replacement for v1's friendships/no_retweet_ids? v1.1 now has an equivalent: https://t.co/gILO7b0U ^TS", "source"=>"<a href=\"http://rubygems.org/gems/twitter\" rel=\"nofollow\">The Ruby Gem</a>", "truncated"=>false, "in_reply_to_status_id"=>nil, "in_reply_to_status_id_str"=>nil, "in_reply_to_user_id"=>nil, "in_reply_to_user_id_str"=>nil, "in_reply_to_screen_name"=>nil, "user"=>{"id"=>213747670, "id_str"=>"213747670", "name"=>"The Twitter Ruby Gem", "screen_name"=>"gem", "location"=>"San Francisco, CA", "description"=>"A Ruby wrapper for Twitter API", "url"=>"http://t.co/rnjr99Mf9o", "entities"=>{"url"=>{"urls"=>[{"url"=>"http://t.co/rnjr99Mf9o", "expanded_url"=>"http://rubygems.org/gems/twitter", "display_url"=>"rubygems.org/gems/twitter", "indices"=>[0, 22]}]}, "description"=>{"urls"=>[]}}, "protected"=>false, "followers_count"=>1183, "friends_count"=>7, "listed_count"=>63, "created_at"=>"Tue Nov 09 18:03:22 +0000 2010", "favourites_count"=>3, "utc_offset"=>-25200, "time_zone"=>"Pacific Time (US & Canada)", "geo_enabled"=>true, "verified"=>false, "statuses_count"=>86, "lang"=>"en", "contributors_enabled"=>false, "is_translator"=>false, "profile_background_color"=>"022330", "profile_background_image_url"=>"http://a0.twimg.com/images/themes/theme15/bg.png", "profile_background_image_url_https"=>"https://si0.twimg.com/images/themes/theme15/bg.png", "profile_background_tile"=>false, "profile_image_url"=>"http://a0.twimg.com/profile_images/2921081357/9e8b8662cd9c4c06887365d559e714a3_normal.png", "profile_image_url_https"=>"https://si0.twimg.com/profile_images/2921081357/9e8b8662cd9c4c06887365d559e714a3_normal.png", "profile_link_color"=>"0084B4", "profile_sidebar_border_color"=>"A8C7F7", "profile_sidebar_fill_color"=>"C0DFEC", "profile_text_color"=>"333333", "profile_use_background_image"=>true, "default_profile"=>false, "default_profile_image"=>false, "following"=>nil, "follow_request_sent"=>false, "notifications"=>nil}, "geo"=>nil, "coordinates"=>nil, "place"=>nil, "contributors"=>nil, "retweeted_status"=>{"created_at"=>"Fri Jan 25 15:47:45 +0000 2013", "id"=>294833948821954560, "id_str"=>"294833948821954560", "text"=>"Looking for a replacement for v1's friendships/no_retweet_ids? v1.1 now has an equivalent: https://t.co/gILO7b0U ^TS", "source"=>"web", "truncated"=>false, "in_reply_to_status_id"=>nil, "in_reply_to_status_id_str"=>nil, "in_reply_to_user_id"=>nil, "in_reply_to_user_id_str"=>nil, "in_reply_to_screen_name"=>nil, "user"=>{"id"=>6253282, "id_str"=>"6253282", "name"=>"Twitter API", "screen_name"=>"twitterapi", "location"=>"San Francisco, CA", "description"=>"The Real Twitter API. I tweet about API changes, service issues and happily answer questions about Twitter and our API. Don't get an answer? It's on my website.", "url"=>"http://t.co/78pYTvWfJd", "entities"=>{"url"=>{"urls"=>[{"url"=>"http://t.co/78pYTvWfJd", "expanded_url"=>"http://dev.twitter.com", "display_url"=>"dev.twitter.com", "indices"=>[0, 22]}]}, "description"=>{"urls"=>[]}}, "protected"=>false, "followers_count"=>1806377, "friends_count"=>35, "listed_count"=>11930, "created_at"=>"Wed May 23 06:01:13 +0000 2007", "favourites_count"=>25, "utc_offset"=>-25200, "time_zone"=>"Pacific Time (US & Canada)", "geo_enabled"=>true, "verified"=>true, "statuses_count"=>3442, "lang"=>"en", "contributors_enabled"=>false, "is_translator"=>false, "profile_background_color"=>"C0DEED", "profile_background_image_url"=>"http://a0.twimg.com/profile_background_images/656927849/miyt9dpjz77sc0w3d4vj.png", "profile_background_image_url_https"=>"https://si0.twimg.com/profile_background_images/656927849/miyt9dpjz77sc0w3d4vj.png", "profile_background_tile"=>true, "profile_image_url"=>"http://a0.twimg.com/profile_images/2284174872/7df3h38zabcvjylnyfe3_normal.png", "profile_image_url_https"=>"https://si0.twimg.com/profile_images/2284174872/7df3h38zabcvjylnyfe3_normal.png", "profile_banner_url"=>"https://pbs.twimg.com/profile_banners/6253282/1347394302", "profile_link_color"=>"0084B4", "profile_sidebar_border_color"=>"C0DEED", "profile_sidebar_fill_color"=>"DDEEF6", "profile_text_color"=>"333333", "profile_use_background_image"=>true, "default_profile"=>false, "default_profile_image"=>false, "following"=>nil, "follow_request_sent"=>false, "notifications"=>nil}, "geo"=>nil, "coordinates"=>nil, "place"=>nil, "contributors"=>[819797], "retweet_count"=>72, "favorite_count"=>45, "entities"=>{"hashtags"=>[], "symbols"=>[], "urls"=>[{"url"=>"https://t.co/gILO7b0U", "expanded_url"=>"https://dev.twitter.com/docs/api/1.1/get/friendships/no_retweets/ids", "display_url"=>"dev.twitter.com/docs/api/1.1/g", "indices"=>[91, 112]}], "user_mentions"=>[]}, "favorited"=>false, "retweeted"=>false, "possibly_sensitive"=>false, "lang"=>"en"}, "retweet_count"=>72, "favorite_count"=>0, "entities"=>{"hashtags"=>[], "symbols"=>[], "urls"=>[{"url"=>"https://t.co/gILO7b0U", "expanded_url"=>"https://dev.twitter.com/docs/api/1.1/get/friendships/no_retweets/ids", "display_url"=>"dev.twitter.com/docs/api/1.1/g", "indices"=>[107, 128]}], "user_mentions"=>[{"screen_name"=>"twitterapi", "name"=>"Twitter API", "id"=>6253282, "id_str"=>"6253282", "indices"=>[3, 14]}]}, "favorited"=>false, "retweeted"=>false, "possibly_sensitive"=>false, "lang"=>"en"},
        {"created_at"=>"Thu Jul 11 09:06:15 +0000 2013", "id"=>355251680712990720, "id_str"=>"355251680712990720", "text"=>"@buster I remember @al3x.", "source"=>"<a href=\"http://rubygems.org/gems/twitter\" rel=\"nofollow\">The Ruby Gem</a>", "truncated"=>false, "in_reply_to_status_id"=>355121456184705024, "in_reply_to_status_id_str"=>"355121456184705024", "in_reply_to_user_id"=>2185, "in_reply_to_user_id_str"=>"2185", "in_reply_to_screen_name"=>"buster", "user"=>{"id"=>213747670, "id_str"=>"213747670", "name"=>"The Twitter Ruby Gem", "screen_name"=>"gem", "location"=>"San Francisco, CA", "description"=>"A Ruby wrapper for Twitter API", "url"=>"http://t.co/rnjr99Mf9o", "entities"=>{"url"=>{"urls"=>[{"url"=>"http://t.co/rnjr99Mf9o", "expanded_url"=>"http://rubygems.org/gems/twitter", "display_url"=>"rubygems.org/gems/twitter", "indices"=>[0, 22]}]}, "description"=>{"urls"=>[]}}, "protected"=>false, "followers_count"=>1183, "friends_count"=>7, "listed_count"=>63, "created_at"=>"Tue Nov 09 18:03:22 +0000 2010", "favourites_count"=>3, "utc_offset"=>-25200, "time_zone"=>"Pacific Time (US & Canada)", "geo_enabled"=>true, "verified"=>false, "statuses_count"=>86, "lang"=>"en", "contributors_enabled"=>false, "is_translator"=>false, "profile_background_color"=>"022330", "profile_background_image_url"=>"http://a0.twimg.com/images/themes/theme15/bg.png", "profile_background_image_url_https"=>"https://si0.twimg.com/images/themes/theme15/bg.png", "profile_background_tile"=>false, "profile_image_url"=>"http://a0.twimg.com/profile_images/2921081357/9e8b8662cd9c4c06887365d559e714a3_normal.png", "profile_image_url_https"=>"https://si0.twimg.com/profile_images/2921081357/9e8b8662cd9c4c06887365d559e714a3_normal.png", "profile_link_color"=>"0084B4", "profile_sidebar_border_color"=>"A8C7F7", "profile_sidebar_fill_color"=>"C0DFEC", "profile_text_color"=>"333333", "profile_use_background_image"=>true, "default_profile"=>false, "default_profile_image"=>false, "following"=>nil, "follow_request_sent"=>false, "notifications"=>nil}, "geo"=>nil, "coordinates"=>nil, "place"=>nil, "contributors"=>nil, "retweet_count"=>0, "favorite_count"=>0, "entities"=>{"hashtags"=>[], "symbols"=>[], "urls"=>[], "user_mentions"=>[{"screen_name"=>"buster", "name"=>"Buster", "id"=>2185, "id_str"=>"2185", "indices"=>[0, 7]}, {"screen_name"=>"al3x", "name"=>"Alex Payne", "id"=>18713, "id_str"=>"18713", "indices"=>[19, 24]}]}, "favorited"=>false, "retweeted"=>false, "lang"=>"en"}
    tweets = TwitterShuwei::UserFetchResult.new(response).parse_timeline
    tweets.first.created_at.should == "Fri Jan 25 19:52:43 +0000 2013"
    tweets.first.text.should == "RT @twitterapi: Looking for a replacement for v1's friendships/no_retweet_ids? v1.1 now has an equivalent: https://t.co/gILO7b0U ^TS"
    tweets.second.created_at.should == "Thu Jul 11 09:06:15 +0000 2013"
    tweets.second.text.should == "@buster I remember @al3x."
  end
end